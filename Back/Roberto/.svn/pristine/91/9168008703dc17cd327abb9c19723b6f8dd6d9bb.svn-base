var Main = {};
Main.administrator = 0;
Main.isMobile = false;
Main.contactOpen = false;

$(document).ready(
    function(){
         if($('#isMobile').length>0)
             Main.isMobile = true;
         
         
         if(!Main.isMobile){
            Tools.delay(500, Main.resize);
            $(window).resize(function(){
               Main.resize();
            });
        }
         Main.bindFunctions();
    }
);


Main.resize = function(){
    var width = parseFloat($(window).width());
    var contentWidth = width*0.9;
    
    if(contentWidth<1024)
        contentWidth = 1024;
    if(contentWidth>1300)
        contentWidth = 1300;
    
    $('.centeredContent').css('width',contentWidth);
    
    //header
    var headerObjectsWidth = parseFloat($('#headerMenuLogo').width());
    $('.headerMenuItem').each(function(){
        headerObjectsWidth += parseFloat($(this).width());
    });
    var headerMargin = Math.floor((contentWidth - headerObjectsWidth)/8)-1;
    $('.headerMenuItem').each(function(){
        $(this).css({'margin-left':headerMargin,'margin-right':headerMargin});
    });
    
    //footer
    var footerLogoLettersWidth = parseFloat($('#footerLogoLetters').width());
    var footerLogoImageWidth = parseFloat($('#footerLogoImage').width());
    var footerCol1Width = parseFloat($('#footerCol1').width());
    var footerCol2Width = parseFloat($('#footerCol2').width());
    var footerCol3Width = parseFloat($('#footerCol3').width());
    var objectsWidth = footerLogoLettersWidth + footerLogoImageWidth + footerCol1Width + footerCol2Width + footerCol3Width;
    var footerMargin = Math.floor((contentWidth - objectsWidth)/4)-1;
    $('#footerLogoImage').css('margin-left',footerMargin);
    $('#footerCol1').css('margin-left',footerMargin);
    $('#footerCol2').css('margin-left',footerMargin);
    $('#footerCol3').css('margin-left',footerMargin);
};

Main.bindFunctions = function(){
    $("#headerContactInfoButton").click(function(){
        Main.toggleContact();
    });
    
    $("#contactSend").click(function(){
        Main.sendContact();
    });
};

Main.toggleContact = function(){
    if(!Main.isMobile){
        if(Main.contactOpen){
            $("#contactDiv").animate({height:"0px"}, 500);
            Main.contactOpen = false;
        }else{
            $("#contactDiv").animate({height:"500px"}, 500);
            Main.contactOpen = true;
        }
    }
};

Main.sendContact = function(){
    var message = {};
    message.name = $("#contactName").val().trim();
    message.phone = $("#contactPhone").val().trim();
    message.email = $("#contactEmail").val().trim();
    message.about = $("#contactAbout").val().trim();
    message.message = $("#contactMessage").val().trim();
    
    if(message.name.length > 0){
        if(message.email.length > 0){
            if(Tools.validateEmail(message.email)){
                if(message.phone.length > 0){
                    if(message.about.length > 0){
                        if(message.message.length > 0){
                            message.area = $("#contactArea").val();
                            var code = Tools.showLoading();
                            $.ajax({
                               url:'/ContactMessages/send',
                               type:'POST',
                               data:{message:message},
                               success:function(response){
                                   Tools.removeLoading(code);
                                   response = $.parseJSON(response);
                                   if(response.status == "ok"){
                                       Tools.alert(response.message);
                                       Main.cleanContact();
                                       Main.toggleContact();
                                   }else{
                                       Tools.alert(response.errorMessage);
                                   }
                               },
                               error:function(){
                                   Tools.removeLoading(code);
                                   Tools.alert($("#internetError").val());
                               }
                            });
                        }else{
                            Tools.alert($("#messageError").val());
                        }
                    }else{
                        Tools.alert($("#aboutError").val());
                    }
                }else{
                    Tools.alert($("#phoneError").val());
                }
            }else{
                Tools.alert($("#invalidEmail").val());
            }
        }else{
            Tools.alert($("#emailError").val());
        }
    }else{
        Tools.alert($("#nameError").val());
    }
};

Main.cleanContact = function(){
    $("#contactName").val("");
    $("#contactPhone").val("");
    $("#contactEmail").val("");
    $("#contactAbout").val("");
    $("#contactMessage").val("");
};